$def with (gameOver, leaders, maxLeaders, gameId, playerID, gameInLeaderboard, gameInMaxLeaders)

$var css: <link rel="stylesheet" href="/static/css/guess-form.css">

$var logout: True

$var link1: <a class="item" href="/setup"><i class="game icon"></i> Back to Levels</a>
$#var link2: <a class="item" href="/restart"><i class="refresh icon"></i> Restart Game</a>


$ leaders = leaders

$ hasWon = gameOver["hasWon"]
$ round = gameOver["round"]
$ goldCoinsInBag = gameOver["goldInBag"]
$ silverCoinsInBag = gameOver["silverInBag"]
$ password = gameOver["password"]
$ length = gameOver["digits"]
$ score = gameOver["score"]

<div class="ui gameover">
    $if hasWon:
        <img class="illu" src="/static/img/fireworks.svg" />
        <h1 class="ui header">You WON!</h1>
        <h3 class="ui header">Congrats! You discovered the Password in $round rounds.</h3>
    $else:
        <img class="illu" src="/static/img/ghost.svg" />
        <h1 class="ui header">You LOST!</h1>
        <h3 class="ui header">You spent all of your Gold and Silver coins, yet couldn't discover the Password.</h3>

    <h1 class="ui header">Your score is: $score</h1>
    <br>
    $ m = '*' * 6
    $ t = '*'

    $ m = '*******\n*     *\n*     *\n*     *\n*     *\n*******'
    <div class="boxes">
    $for i in range(length):
        <div class="box"><pre data-pass="$password[i]">$m</pre></div>
    </div>

    <div class="coin-bags">
        <div class="coin-bag gold">
            <svg enable-background="new 0 0 24 24" id="Layer_1" version="1.0" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M11.2,4.3c0.3,0.4,0.7,0.6,1.1,0.8C12.1,5.6,12,6,11.9,6.4c-0.1,0-0.3,0-0.4,0l-0.1,0c-0.3,0-0.7-0.1-1-0.1   c-0.1-0.2-0.3-0.5-0.4-0.7C10,5.5,9.9,5.4,9.9,5.4C10.3,5.2,10.8,4.8,11.2,4.3 M11.2,2C11.2,2,11.2,2,11.2,2c-0.5,0-1,0.1-1.5,0.9   c-0.4,0.7-1,0.7-1.9,0.7c-0.8,0-1,0.6-0.6,1.2c0.2,0.3,1.5,2.5,1.8,3c0.3,0.4,1.5,0.7,2.4,0.7c0.1,0,0.1,0,0.2,0   c0.9,0,2.3-0.4,2.2-1.1c-0.1-1.3,1.2-3,1.4-3.2c0.3-0.4,0.2-1.3-0.6-1.3c-0.2,0-0.4,0-0.6,0.1c-0.2,0.1-0.5,0.2-0.8,0.2   c-0.2,0-0.4-0.1-0.5-0.3C12.1,2.1,11.6,2,11.2,2L11.2,2z"/></g><g><path d="M9,7.8c0.3,0.5,1.7,0.7,2.6,0.7c0.9,0,2.3-0.4,2.2-1.1c-0.1-1.3,1.2-3,1.4-3.2c-0.4,0.2-0.7,0.5-1.1,0.4   C13.9,4.8,13.4,6,12.4,6c-0.7,0-0.8-1-1.3-1c-0.5,0-0.6,0.7-1,0.8C9.2,6,8.5,5.1,8,4.5c-0.2,0-0.6-0.3-0.8,0.4   C7.4,5.1,8.7,7.3,9,7.8z"/></g><path d="M13.6,8.8c-0.7,0.3-1.5,0.5-2,0.5l-0.2,0c-0.2,0-1.1,0-1.9-0.3C5.2,10.3,2,14.7,2,17.8C2,21.5,6.5,22,12,22s10-0.5,10-4.2  C22,14.5,18.4,9.8,13.6,8.8z M11.6,14.5c0.1,0.1,0.3,0.3,0.6,0.5c0.6,0.2,1.1,0.5,1.4,0.8c0.3,0.3,0.5,0.8,0.5,1.4  c0,0.5-0.2,1-0.5,1.3c-0.3,0.3-0.7,0.5-1.2,0.6V20h-0.7v-0.9c-0.5-0.1-1-0.3-1.3-0.6c-0.3-0.3-0.5-0.9-0.5-1.5l0,0h1.3  c0,0.4,0.1,0.7,0.2,0.9s0.4,0.3,0.6,0.3c0.2,0,0.4-0.1,0.5-0.2c0.1-0.2,0.2-0.4,0.2-0.6c0-0.3-0.1-0.5-0.2-0.6  c-0.1-0.2-0.3-0.3-0.6-0.5c-0.6-0.2-1.1-0.5-1.4-0.8s-0.5-0.8-0.5-1.3c0-0.5,0.2-1,0.5-1.3c0.3-0.3,0.7-0.5,1.2-0.6v-1h0.7v1  c0.5,0.1,0.9,0.3,1.2,0.7s0.4,0.8,0.4,1.4h-1.3c0-0.3-0.1-0.6-0.2-0.8c-0.1-0.2-0.3-0.3-0.5-0.3c-0.2,0-0.4,0.1-0.5,0.2  c-0.1,0.2-0.1,0.4-0.1,0.6C11.5,14.2,11.5,14.4,11.6,14.5z"/></svg>
            $if hasWon:
              $if goldCoinsInBag > 0:
                <span>$goldCoinsInBag</span>
              $else:
                <span>0</span>
            $else:
                <span>0</span>
        </div>
        <div class="coin-bag silver">
            <svg enable-background="new 0 0 24 24" id="Layer_1" version="1.0" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M11.2,4.3c0.3,0.4,0.7,0.6,1.1,0.8C12.1,5.6,12,6,11.9,6.4c-0.1,0-0.3,0-0.4,0l-0.1,0c-0.3,0-0.7-0.1-1-0.1   c-0.1-0.2-0.3-0.5-0.4-0.7C10,5.5,9.9,5.4,9.9,5.4C10.3,5.2,10.8,4.8,11.2,4.3 M11.2,2C11.2,2,11.2,2,11.2,2c-0.5,0-1,0.1-1.5,0.9   c-0.4,0.7-1,0.7-1.9,0.7c-0.8,0-1,0.6-0.6,1.2c0.2,0.3,1.5,2.5,1.8,3c0.3,0.4,1.5,0.7,2.4,0.7c0.1,0,0.1,0,0.2,0   c0.9,0,2.3-0.4,2.2-1.1c-0.1-1.3,1.2-3,1.4-3.2c0.3-0.4,0.2-1.3-0.6-1.3c-0.2,0-0.4,0-0.6,0.1c-0.2,0.1-0.5,0.2-0.8,0.2   c-0.2,0-0.4-0.1-0.5-0.3C12.1,2.1,11.6,2,11.2,2L11.2,2z"/></g><g><path d="M9,7.8c0.3,0.5,1.7,0.7,2.6,0.7c0.9,0,2.3-0.4,2.2-1.1c-0.1-1.3,1.2-3,1.4-3.2c-0.4,0.2-0.7,0.5-1.1,0.4   C13.9,4.8,13.4,6,12.4,6c-0.7,0-0.8-1-1.3-1c-0.5,0-0.6,0.7-1,0.8C9.2,6,8.5,5.1,8,4.5c-0.2,0-0.6-0.3-0.8,0.4   C7.4,5.1,8.7,7.3,9,7.8z"/></g><path d="M13.6,8.8c-0.7,0.3-1.5,0.5-2,0.5l-0.2,0c-0.2,0-1.1,0-1.9-0.3C5.2,10.3,2,14.7,2,17.8C2,21.5,6.5,22,12,22s10-0.5,10-4.2  C22,14.5,18.4,9.8,13.6,8.8z M11.6,14.5c0.1,0.1,0.3,0.3,0.6,0.5c0.6,0.2,1.1,0.5,1.4,0.8c0.3,0.3,0.5,0.8,0.5,1.4  c0,0.5-0.2,1-0.5,1.3c-0.3,0.3-0.7,0.5-1.2,0.6V20h-0.7v-0.9c-0.5-0.1-1-0.3-1.3-0.6c-0.3-0.3-0.5-0.9-0.5-1.5l0,0h1.3  c0,0.4,0.1,0.7,0.2,0.9s0.4,0.3,0.6,0.3c0.2,0,0.4-0.1,0.5-0.2c0.1-0.2,0.2-0.4,0.2-0.6c0-0.3-0.1-0.5-0.2-0.6  c-0.1-0.2-0.3-0.3-0.6-0.5c-0.6-0.2-1.1-0.5-1.4-0.8s-0.5-0.8-0.5-1.3c0-0.5,0.2-1,0.5-1.3c0.3-0.3,0.7-0.5,1.2-0.6v-1h0.7v1  c0.5,0.1,0.9,0.3,1.2,0.7s0.4,0.8,0.4,1.4h-1.3c0-0.3-0.1-0.6-0.2-0.8c-0.1-0.2-0.3-0.3-0.5-0.3c-0.2,0-0.4,0.1-0.5,0.2  c-0.1,0.2-0.1,0.4-0.1,0.6C11.5,14.2,11.5,14.4,11.6,14.5z"/></svg>
            $if hasWon:
              $if silverCoinsInBag > 0:
                <span>$silverCoinsInBag</span>
              $else:
                <span>0</span>
            $else:
                <span>0</span>
        </div>
    </div>

    <div class="ui center aligned grid">
        <form action="/game">
            <button type="submit" class="ui basic button">See Game Summary</button>
        </form>
        <form action="/setup">
            <button type="submit" class="ui primary button">Continue</button>
        </form>
    </div>

    <br>
    <div class="ui section divider"></div>

    <h3 class="ui header">Leaderboard</h3>

        <div class="ui top attached tabular menu">
            <a class="item active" data-tab="Game-Based">Game Based</a>
            <a class="item" data-tab="Player-Based">Player Based</a>
        </div>

        <div class="ui bottom attached tab segment active" data-tab="Game-Based">
            <table class="ui celled table unstackable">
                <thead>
                    <tr>
                <th>Rank</th>
                <th>Player</th>
                <th>Score</th>
                <th>Badge</th>
                    </tr>
                </thead>
                <tbody>
                    $ i = 1
                    $for leader in leaders:
                        $if leader['badge'] == "Ruby":
                            $ cls = "orange"
                        $elif leader['badge'] == "Sapphire":
                            $ cls = "blue"
                        $elif leader['badge'] == "Emerald":
                            $ cls = "green"
                        $elif leader['badge'] == "Diamond":
                            $ cls = "grey"

                        $if leader['game_id'] == gameId:
                            <tr class="warning">
                                <td>$(i) <i class="trophy icon"></i></td>
                        $else:
                            <tr>
                                <td>$(i)</td>

                        <td>$leader['username']</td>
                        <td>$leader['score']</td>
                        <td><i class="diamond $cls icon"></i> $leader['badge']</td>
                        </tr>
                        $ i = i + 1

                    $if hasWon and gameInLeaderboard['inHighScores'] == False:
                        <tr>
                            <td>...</td>
                            <td>...</td>
                            <td>...</td>
                            <td>...</td>
                        </tr>
                        <tr class="warning">
                            <td><i class="thumbs outline up icon"></i> You</td>
                            <td>$gameInLeaderboard['username']</td>
                            <td>$gameInLeaderboard['score']</td>
                            <td><i class="diamond $cls icon"></i> $gameInLeaderboard['badge']</td>
                        </tr>
                </tbody>
            </tbody>  <!-- ???? -->
            <tfoot>
                <tr>
                <th colspan="4">
                    <form method="GET" action="/leaderboard">
                        <div class="field">
                          <button class="ui button right floated" type="submit">See The Full Leaderboard</button>
                        </div>
                    </form>
                </th>
                </tr>
            </tfoot>
            </table>
        </div>

        <div class="ui bottom attached tab segment" data-tab="Player-Based">
            <table class="ui celled table unstackable">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Player</th>
                        <th>Total Score</th>
                        <th>Total Wins</th>
                    </tr>
                </thead>
                <tbody>
                    $ i = 1
                    $for maxLeader in maxLeaders:
                        $if maxLeader["wins"] >= 30:
                            $ cls = 5
                        $elif maxLeader["wins"] >= 20:
                            $ cls = 4
                        $elif maxLeader["wins"] >= 10:
                            $ cls = 3
                        $elif maxLeader["wins"] >= 5:
                            $ cls = 2
                        $else:
                            $ cls = 1

                        $if maxLeader['id'] == playerID:
                            <tr class="warning">
                                <td>$(i) <i class="trophy icon"></i></td>
                        $else:
                            <tr>
                                <td>$(i)</td>

                        <td>$maxLeader["username"]</td>
                        <td>$maxLeader["totalScore"]</td>
                        <td>
                        $for k in range(cls):
                            <i class="star red icon"></i>
                        $maxLeader["wins"]</td>
                        </tr>
                        $ i = i + 1

                    $if hasWon and gameInMaxLeaders['inMaxScores'] == False:
                        <tr>
                            <td>...</td>
                            <td>...</td>
                            <td>...</td>
                            <td>...</td>
                        </tr>
                        <tr class="warning">
                            <td><i class="thumbs outline up icon"></i> You</td>
                            <td>$gameInMaxLeaders['username']</td>
                            <td>$gameInMaxLeaders['totalScore']</td>
                            <td><i class="star $cls icon"></i> $gameInMaxLeaders['wins']</td>
                        </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="4">
                        <form method="GET" action="/leaderboard">
                            <div class="field">
                              <button class="ui button right floated" type="submit">See The Full Leaderboard</button>
                            </div>
                        </form>>
                        </th>
                    </tr>
                </tfoot>
            </table>
        </div>

<script>
    $$(document).ready(function(){
        $$('.menu .item').tab();
    });
</script>

